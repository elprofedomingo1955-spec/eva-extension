<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Extensi√≥n EVA - Selectores Actualizados</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîß Test Extensi√≥n EVA - Selectores Actualizados</h1>
    
    <div class="test-section">
        <h2>üìã Resumen de Correcciones Realizadas</h2>
        <ul>
            <li class="success">‚úÖ Selectores de textarea actualizados en content.js</li>
            <li class="success">‚úÖ Selectores de bot√≥n enviar corregidos</li>
            <li class="success">‚úÖ Selectores de mensajes/respuestas actualizados</li>
            <li class="success">‚úÖ Observer actualizado para estructura ChatGPT 2025</li>
            <li class="success">‚úÖ Funci√≥n tryInjectToPage agregada</li>
            <li class="success">‚úÖ Manifest.json corregido y completado</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üéØ Selectores Cr√≠ticos Actualizados</h2>
        
        <h3>1. Textarea del Composer:</h3>
        <pre>
// ANTES (no funcionaba):
textarea[name="prompt-textarea"]

// AHORA (actualizado):
textarea[name="prompt-textarea"] ||
textarea[data-virtualkeyboard="true"] ||
textarea
        </pre>

        <h3>2. Bot√≥n de Env√≠o:</h3>
        <pre>
// ANTES (no funcionaba):
button[data-testid="send-button"]

// AHORA (actualizado):
- Busca en .composer-parent
- Detecta botones con SVG espec√≠ficos
- Fallback a botones de formulario
        </pre>

        <h3>3. Contenedor de Mensajes:</h3>
        <pre>
// ANTES (limitado):
div[data-testid="conversation-turns"]

// AHORA (robusto):
#thread ||
main#main ||
.group/thread ||
div[data-testid="conversation-turns"]
        </pre>

        <h3>4. Detecci√≥n de Respuestas:</h3>
        <pre>
// NUEVOS SELECTORES:
div[data-message-author-role="assistant"]
div[data-message-author-role="user"]
.text-base
div[class*="message"] div
        </pre>
    </div>

    <div class="test-section">
        <h2>üîß Archivos Modificados</h2>
        <ul>
            <li><strong>src/content/content.js</strong> - Selectores de DOM actualizados</li>
            <li><strong>src/popup/popup.js</strong> - Funci√≥n tryInjectToPage agregada</li>
            <li><strong>src/popup/observer.js</strong> - Observer mejorado</li>
            <li><strong>src/manifest.json</strong> - Corregido y completado</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üìù Instrucciones de Instalaci√≥n</h2>
        <ol>
            <li>Abre Chrome y ve a <code>chrome://extensions/</code></li>
            <li>Activa "Modo de desarrollador" (esquina superior derecha)</li>
            <li>Haz clic en "Cargar extensi√≥n sin empaquetar"</li>
            <li>Selecciona la carpeta <code>src/</code> de tu proyecto</li>
            <li>Ve a <code>chatgpt.com</code></li>
            <li>Haz clic en el icono de la extensi√≥n EVA</li>
            <li>Prueba escribir un mensaje y enviarlo</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>üêõ Soluci√≥n al Problema Original</h2>
        <p class="info">
            <strong>Problema:</strong> Despu√©s de "limpiar" todo, la extensi√≥n dej√≥ de funcionar.<br>
            <strong>Causa:</strong> ChatGPT actualiz√≥ su estructura DOM y los selectores antiguos ya no funcionaban.<br>
            <strong>Soluci√≥n:</strong> Actualizaci√≥n completa de selectores basada en el an√°lisis del HTML real de ChatGPT 2025.
        </p>
    </div>

    <div class="test-section">
        <h2>‚ú® Funcionalidades Restauradas</h2>
        <ul>
            <li>‚úÖ Inyecci√≥n de texto en el composer de ChatGPT</li>
            <li>‚úÖ Detecci√≥n autom√°tica del bot√≥n de env√≠o</li>
            <li>‚úÖ Captura de respuestas de ChatGPT</li>
            <li>‚úÖ Observador de cambios en el DOM</li>
            <li>‚úÖ Almacenamiento de bit√°cora</li>
            <li>‚úÖ Descarga de conversaciones</li>
        </ul>
    </div>

    <script>
        console.log('üöÄ Extensi√≥n EVA - Test de Selectores Actualizados');
        console.log('üìÖ Fecha de correcci√≥n:', new Date().toLocaleString());
        console.log('üéØ Selectores actualizados para ChatGPT 2025');
    </script>
</body>
</html>